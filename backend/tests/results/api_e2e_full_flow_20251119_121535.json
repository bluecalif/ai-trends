{
  "test_name": "test_api_e2e_full_flow",
  "timestamp": "20251119_121535",
  "data_preparation": {
    "sources_created": 0,
    "items_collected": 0,
    "items_in_db": 100,
    "status": "completed"
  },
  "api_tests": {
    "items": {},
    "sources": {},
    "persons": {},
    "bookmarks": {},
    "watch_rules": {},
    "insights": {}
  },
  "status": "error",
  "error": "(psycopg2.errors.UndefinedFunction) operator does not exist: json ~~ text\nLINE 4: WHERE (items.custom_tags LIKE '%' || '[\"agents\"]'::JSON || '...\n                                 ^\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT items.source_id AS items_source_id, items.title AS items_title, items.summary_short AS items_summary_short, items.link AS items_link, items.published_at AS items_published_at, items.author AS items_author, items.thumbnail_url AS items_thumbnail_url, items.iptc_topics AS items_iptc_topics, items.iab_categories AS items_iab_categories, items.custom_tags AS items_custom_tags, items.dup_group_id AS items_dup_group_id, items.id AS items_id, items.created_at AS items_created_at, items.updated_at AS items_updated_at \nFROM items \nWHERE (items.custom_tags LIKE '%%' || %(custom_tags_1)s::JSON || '%%') ORDER BY items.published_at DESC) AS anon_1]\n[parameters: {'custom_tags_1': '[\"agents\"]'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)",
  "traceback": "Traceback (most recent call last):\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\npsycopg2.errors.UndefinedFunction: operator does not exist: json ~~ text\nLINE 4: WHERE (items.custom_tags LIKE '%' || '[\"agents\"]'::JSON || '...\n                                 ^\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Projects\\vibe-coding\\ai-trend\\backend\\tests\\e2e\\test_api_e2e.py\", line 129, in test_api_e2e_full_flow\n    response = client.get(\"/api/items?custom_tag=agents&page=1&page_size=5\")\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\testclient.py\", line 523, in get\n    return super().get(\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\httpx\\_client.py\", line 1055, in get\n    return self.request(\n           ^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\testclient.py\", line 491, in request\n    return super().request(\n           ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\httpx\\_client.py\", line 828, in request\n    return self.send(request, auth=auth, follow_redirects=follow_redirects)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\httpx\\_client.py\", line 915, in send\n    response = self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\httpx\\_client.py\", line 943, in _send_handling_auth\n    response = self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\httpx\\_client.py\", line 980, in _send_handling_redirects\n    response = self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\httpx\\_client.py\", line 1016, in _send_single_request\n    response = transport.handle_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\testclient.py\", line 372, in handle_request\n    raise exc\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\testclient.py\", line 369, in handle_request\n    portal.call(self.app, scope, receive, send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\anyio\\from_thread.py\", line 321, in call\n    return cast(T_Retval, self.start_task_soon(func, *args).result())\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\anaconda3\\Lib\\concurrent\\futures\\_base.py\", line 456, in result\n    return self.__get_result()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\anaconda3\\Lib\\concurrent\\futures\\_base.py\", line 401, in __get_result\n    raise self._exception\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\anyio\\from_thread.py\", line 252, in _call_func\n    retval = await retval_or_awaitable\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\fastapi\\applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\applications.py\", line 123, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 186, in __call__\n    raise exc\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 64, in wrapped_app\n    raise exc\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\routing.py\", line 758, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\routing.py\", line 778, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\routing.py\", line 299, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\routing.py\", line 79, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 64, in wrapped_app\n    raise exc\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\starlette\\routing.py\", line 74, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\fastapi\\routing.py\", line 299, in app\n    raise e\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\fastapi\\routing.py\", line 294, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Projects\\vibe-coding\\ai-trend\\backend\\app\\api\\items.py\", line 88, in get_items\n    total = query.count()\n            ^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 3146, in count\n    self._legacy_from_self(col).enable_eagerloads(False).scalar()\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 2835, in scalar\n    ret = self.one()\n          ^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 2808, in one\n    return self._iter().one()  # type: ignore\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\orm\\query.py\", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2351, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2249, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\User\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ai-trend-7wjlO0ts-py3.12\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) operator does not exist: json ~~ text\nLINE 4: WHERE (items.custom_tags LIKE '%' || '[\"agents\"]'::JSON || '...\n                                 ^\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT items.source_id AS items_source_id, items.title AS items_title, items.summary_short AS items_summary_short, items.link AS items_link, items.published_at AS items_published_at, items.author AS items_author, items.thumbnail_url AS items_thumbnail_url, items.iptc_topics AS items_iptc_topics, items.iab_categories AS items_iab_categories, items.custom_tags AS items_custom_tags, items.dup_group_id AS items_dup_group_id, items.id AS items_id, items.created_at AS items_created_at, items.updated_at AS items_updated_at \nFROM items \nWHERE (items.custom_tags LIKE '%%' || %(custom_tags_1)s::JSON || '%%') ORDER BY items.published_at DESC) AS anon_1]\n[parameters: {'custom_tags_1': '[\"agents\"]'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n"
}